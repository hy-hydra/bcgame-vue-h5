const{utils:t,gsap:i,Container:e,ColorMatrixFilter:s,Assets:n,Texture:h,Sprite:a,Point:o,BitmapText:l,Graphics:r}=__PIXIV7__;class d extends t.EventEmitter{constructor(){super(),this.container=new e,this.botBgContainer=new e,this.topBgContainer=new e,this.hitContainer=new e,this.topContainer=new e,this.index=0,this.isSel=!1,this.isClickable=!0,this.isHit=!1,this.callFun=null,this.callObj=null}init(t,i){this.index=t,this.isSel=!1,this.isClickable=!0,this.isHit=!1,this.botBg=new r,this.botBg.clear(),this.botBg.beginFill(16777215,1),this.botBg.drawRoundedRect(0,0,40,40,6),this.botBg.endFill(),this.botBg.tint=1842463,this.botBgContainer.addChild(this.botBg),this.topBg=new r,this.topBg.clear(),this.topBg.beginFill(16777215,1),this.topBg.drawRoundedRect(0,0,40,40,6),this.topBg.endFill(),this.topBg.tint=2105894,this.topBgContainer.addChild(this.topBg),this.topContainer.addChild(this.topBgContainer);const e=new r;e.clear(),e.beginFill(0,.4),e.drawRect(-16,-16,32,32),e.endFill(),this.hitContainer.addChild(e);const s=new a(i);s.anchor.set(.5),s.width*=.7,s.height*=.7,this.hitContainer.addChild(s),this.hitContainer.x=this.topContainer.width/2,this.hitContainer.y=this.topContainer.height/2,this.topContainer.addChild(this.hitContainer),this.hitContainer.visible=!1,this.numText=new l(""+t,{align:"center",fontName:"lan",fontSize:16,tint:10462381}),this.numText.anchor.set(.5),this.numText.x=this.topContainer.width/2,this.numText.y=this.topContainer.height/2,this.topContainer.addChild(this.numText),this.botBgContainer.y=6,this.container.addChild(this.botBgContainer),this.container.addChild(this.topContainer),this.container.eventMode="static",this.container.cursor="pointer",this.container.on("pointerover",(()=>{this.isClickable&&!this.isHit&&(this.isSel||(this.topBg.tint=4211532),this.tweenBotDown(),this.tweenTopUpOne())})),this.container.on("pointerdown",(()=>{this.isClickable&&!this.isHit&&this.tweenTopDownTwo()})),this.container.on("pointerup",(()=>{this.isClickable&&(this.isSel?(this.botBg.tint=1842463,this.topBg.tint=4211532,this.numText.tint=10462381,this.isSel=!1):(this.botBg.tint=4854181,this.topBg.tint=7473141,this.numText.tint=16777215,this.isSel=!0),this.isHit||this.tweenTopUpOne(),this.callFun.call(this.callObj,this.index,this.isSel))})),this.container.on("pointerleave",(()=>{this.isClickable&&!this.isHit&&(this.isSel||(this.topBg.tint=2105894),this.tweenBotUp(),this.tweenTopDownOne())})),this.maskShape=new r,this.maskShape.clear(),this.maskShape.beginFill(0,.4),this.maskShape.drawRect(0,0,this.container.width,this.container.height),this.maskShape.endFill(),this.container.addChild(this.maskShape),this.maskShape.visible=!this.isClickable}showHit(){return this.isHit=!0,this.isSel?(console.log("被击中了：",this.index),this.hitContainer.visible=!0,this.numText.tint=6696337,1):(console.error("没有被击中：",this.index),this.hitContainer.visible=!1,this.numText.tint=14294051,0)}clearHit(){this.isHit&&(this.hitContainer.visible=!1,this.isSel?this.numText.tint=16777215:this.numText.tint=10462381,this.isHit=!1)}setSelCallbackFun(t,i){this.callFun=t,this.callObj=i}setMaskAvailable(t){t?this.isSel||this.isClickable||(this.maskShape.visible=!1,this.isClickable=!0):!this.isSel&&this.isClickable&&(this.maskShape.visible=!0,this.isClickable=!1)}tweenTopUpOne(){i.to(this.topContainer,{duration:.2,y:-4})}tweenTopUpTwo(){i.to(this.topContainer,{duration:.2,y:0})}tweenTopDownOne(){i.to(this.topContainer,{duration:.2,y:0})}tweenTopDownTwo(){i.to(this.topContainer,{duration:.2,y:2})}tweenBotDown(){i.to(this.botBgContainer,{duration:.2,y:8})}tweenBotUp(){i.to(this.botBgContainer,{duration:.2,y:6})}getUI(){return this.container}}const{utils:c,gsap:g,Container:p,ColorMatrixFilter:C,Assets:u,Texture:w,Sprite:b,Point:m,BitmapText:x,Graphics:y}=__PIXIV7__;class k extends c.EventEmitter{constructor(){super(),this.container=new p,this.goldIco=null,this.grayIco=null}init(t,i,e,s,n){this.bg=new y,this.bg.clear(),this.bg.beginFill(16777215,1),this.bg.drawRoundedRect(0,0,e,40,6),this.bg.endFill(),this.bg.tint=1842463,this.container.addChild(this.bg),this.goldIco=s,this.grayIco=n,this.icoImage=new b(n),this.icoImage.anchor.set(.5),this.icoImage.width*=.7,this.icoImage.height*=.7,this.icoImage.x=this.icoImage.width/2+6,this.icoImage.y=20,this.container.addChild(this.icoImage),this.hitNumText=new x(""+t,{align:"center",fontName:"lan",fontSize:16,tint:10462381}),this.hitNumText.anchor.set(.5),this.hitNumText.x=this.icoImage.x,this.hitNumText.y=this.icoImage.y,this.container.addChild(this.hitNumText),this.payoutText=new x(i+"x",{align:"center",fontName:"lan",fontSize:16,tint:16777215}),this.payoutText.anchor.set(.5),this.payoutText.x=e/2+this.icoImage.width/2+3,this.payoutText.y=this.icoImage.y,this.container.addChild(this.payoutText)}showHitStatus(){this.bg.tint=7473141,this.icoImage.texture=this.goldIco}clearHitStatus(){this.bg.tint=1842463,this.icoImage.texture=this.grayIco}getUI(){return this.container}}const{utils:S,gsap:T,Container:B,ColorMatrixFilter:I,Assets:F,Texture:f,Sprite:R,Point:v,BitmapText:N,Graphics:U}=__PIXIV7__;class _ extends S.EventEmitter{constructor({app:t,game:i}){super(),this.game=i,this.inited=!1,this.app=t,this.container=new B,this.blocksContainer=new B,this.rateContainer=new B,this.uiContainer=new B,this.images={},this.isStart=!1,this.blocks={},this.selNumbers=[],this.payouts=[0,1,1.4,2.2,4,7.2,8.25,9.15,10.28,17],this.tips={},this.needClear=!1}async init(){await this.loadRes()}resize(){this.width=this.app.screen.width,this.height=this.app.screen.height}tick(t){}reset(){this.needClear&&(this.clearLastStatus(),this.isStart=!1)}start(){if(this.isStart)return;this.isStart=!0;let t=[],i=0,e=0;for(e=0;e<40;e++)t.push(e+1);for(e=0;e<10;e++){let e=t.splice(Math.floor(Math.random()*t.length),1);i+=this.blocks[e].showHit()}console.info("最终击中个数：",i),i>0&&(this.tips[i].showHitStatus(),this.payouts[i-1]),this.needClear=!0}mount(){this.resize(),this.app.ticker.add(this.tick,this),this.showBlocksUI()}unmount(){this.app.ticker.remove(this.tick,this)}destroy(){this.unmount(),this.container.destroy(),this.container=null,this.app=null}async loadRes(){await F.load("./lan.fnt");let t=await F.load("/keno/goldIco.png");this.images.goldIco=t;let i=await F.load("/keno/grayIco.png");this.images.grayIco=i}showUI(){this.riskText=new N("Risk",{align:"center",fontName:"lan",fontSize:20,tint:10462381}),this.uiContainer.addChild(this.riskText);const t=new U;t.clear(),t.beginFill(2105894,1),t.drawRoundedRect(0,0,this.width-20,60,6),t.endFill(),t.y=30,this.uiContainer.addChild(t);const i=new U;i.clear(),i.beginFill(7368816,1),i.drawRoundedRect(0,0,(this.width-20-30)/4,56,6),i.endFill(),i.x=6,i.y=32,this.uiContainer.addChild(i);const e=new N("Low",{align:"center",fontName:"lan",fontSize:18,tint:16777215});e.anchor.set(.5),e.x=i.x+i.width/2,e.y=i.y+i.height/2,this.uiContainer.addChild(e);const s=new U;s.clear(),s.beginFill(7368816,1),s.drawRoundedRect(0,0,(this.width-20-30)/4,56,6),s.endFill(),s.x=(this.width-20-30)/4+6+6,s.y=32,this.uiContainer.addChild(s);const n=new N("Classic",{align:"center",fontName:"lan",fontSize:18,tint:16777215});n.anchor.set(.5),n.x=s.x+s.width/2,n.y=s.y+s.height/2,this.uiContainer.addChild(n);const h=new U;h.clear(),h.beginFill(7368816,1),h.drawRoundedRect(0,0,(this.width-20-30)/4,56,6),h.endFill(),h.x=2*((this.width-20-30)/4+6)+6,h.y=32,this.uiContainer.addChild(h);const a=new N("Medium",{align:"center",fontName:"lan",fontSize:18,tint:16777215});a.anchor.set(.5),a.x=h.x+h.width/2,a.y=h.y+h.height/2,this.uiContainer.addChild(a);const o=new U;o.clear(),o.beginFill(7368816,1),o.drawRoundedRect(0,0,(this.width-20-30)/4,56,6),o.endFill(),o.x=3*((this.width-20-30)/4+6)+6,o.y=32,this.uiContainer.addChild(o);const l=new N("High",{align:"center",fontName:"lan",fontSize:18,tint:16777215});l.anchor.set(.5),l.x=o.x+o.width/2,l.y=o.y+o.height/2,this.uiContainer.addChild(l);const r=new U;r.clear(),r.beginFill(6219322,1),r.drawRoundedRect(0,0,this.width-20,60,6),r.endFill(),r.y=110,this.uiContainer.addChild(r);const d=new N("START",{align:"center",fontName:"lan",fontSize:18,tint:0});d.anchor.set(.5),d.x=r.x+r.width/2,d.y=r.y+r.height/2,this.uiContainer.addChild(d),this.uiContainer.x=10,this.uiContainer.y=this.height-this.uiContainer.height-120,this.container.addChild(this.uiContainer),i.eventMode="static",i.cursor="pointer",i.on("pointertap",(()=>{i.alpha=1,s.alpha=.1,h.alpha=.1,o.alpha=.1,e.tint=16777215,n.tint=8355711,a.tint=8355711,l.tint=8355711})),s.eventMode="static",s.cursor="pointer",s.on("pointertap",(()=>{i.alpha=.1,s.alpha=1,h.alpha=.1,o.alpha=.1,e.tint=8355711,n.tint=16777215,a.tint=8355711,l.tint=8355711})),h.eventMode="static",h.cursor="pointer",h.on("pointertap",(()=>{i.alpha=.1,s.alpha=.1,h.alpha=1,o.alpha=.1,e.tint=8355711,n.tint=8355711,a.tint=16777215,l.tint=8355711})),o.eventMode="static",o.cursor="pointer",o.on("pointertap",(()=>{i.alpha=.1,s.alpha=.1,h.alpha=.1,o.alpha=1,e.tint=8355711,n.tint=8355711,a.tint=8355711,l.tint=16777215})),i.alpha=1,s.alpha=.1,h.alpha=.1,o.alpha=.1,e.tint=16777215,n.tint=8355711,a.tint=8355711,l.tint=8355711,r.eventMode="static",r.cursor="pointer",r.on("pointertap",(()=>{0!=this.selNumbers.length&&this.start()}))}showBlocksUI(){let t,i=0;for(t=0;t<4;t++)for(i=0;i<10;i++){let e=new d;e.init(10*t+i+1,this.images.goldIco),e.getUI().x=44*i,e.getUI().y=60*t,e.setSelCallbackFun(this.blockSelHandler,this),this.blocksContainer.addChild(e.getUI()),this.blocks[10*t+i+1]=e}let e=(this.width-20)/this.blocksContainer.width;this.blocksContainer.width*=e,this.blocksContainer.height*=e,this.blocksContainer.x=10,this.blocksContainer.y=20,this.container.addChild(this.blocksContainer),this.initRateContainer();const s=new U;s.clear(),s.beginFill(0,1),s.drawRoundedRect(0,0,this.width,this.blocksContainer.height+this.rateContainer.height+40,6),s.endFill(),s.y=10,this.container.addChildAt(s,0)}initRateContainer(){const t=new U;t.clear(),t.beginFill(4211532,1),t.drawRoundedRect(0,0,this.width-20,100,6),t.endFill(),t.y=0,this.rateContainer.addChild(t);const i=new U;i.clear(),i.beginFill(6219322,1),i.drawRoundedRect(0,0,this.width-20,6,3),i.endFill(),i.y=t.y+t.height+1,this.rateContainer.addChild(i),this.rateContainer.y=this.blocksContainer.y+this.blocksContainer.height+20,this.rateContainer.x=10,this.container.addChild(this.rateContainer);let e=(this.width-26-24)/5;for(let t=0;t<this.payouts.length;t++){let i=new k;i.init(t+1,this.payouts[t],e,this.images.goldIco,this.images.grayIco),i.getUI().x=3+t%5*(e+6),i.getUI().y=6+46*Math.floor(t/5),this.rateContainer.addChild(i.getUI()),i.getUI().visible=!1,this.tips[t+1]=i}this.tipText=new N("Select 1 - 10 numbers to play",{align:"center",fontName:"lan",fontSize:16,tint:16777215}),this.tipText.anchor.set(.5),this.tipText.x=this.width/2-10,this.tipText.y=t.y+50,this.rateContainer.addChild(this.tipText)}blockSelHandler(t,i){let e;for(e in this.needClear&&(this.clearLastStatus(),this.isStart=!1),i&&-1==this.selNumbers.indexOf(t)&&(this.selNumbers.push(t),this.tips[this.selNumbers.length].getUI().visible=!0,this.tipText.visible=!1),i||-1==this.selNumbers.indexOf(t)||(console.log("删去数组中的一个数字"),this.tips[this.selNumbers.length].getUI().visible=!1,this.selNumbers.splice(this.selNumbers.indexOf(t),1),0==this.selNumbers.length&&(this.tipText.visible=!0)),this.blocks)this.blocks[e].setMaskAvailable(this.selNumbers.length<10)}clearLastStatus(){let t;for(t in this.tips)this.tips[t].clearHitStatus();for(t in this.blocks)this.blocks[t].clearHit()}test(){this.botBg=new U,this.botBg.clear(),this.botBg.beginFill(16777215,1),this.botBg.drawRoundedRect(0,0,40,40,6),this.botBg.endFill(),this.botBg.x=this.width/2,this.botBg.y=this.height/2,this.botBg.tint=7473041,this.container.addChild(this.botBg),T.to(this.botBg,{duration:.5,tint:7473141})}}window.__GLSDK_SETUP__&&window.__GLSDK_SETUP__({name:"keno",version:"1.0.0"},_);
